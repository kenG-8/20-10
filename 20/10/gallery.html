<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Carousel 3D c·ªë ƒë·ªãnh (21 ·∫£nh)</title>
<style>
  :root{
    --bg1: #fff6fb;
    --bg2: #ffd9e6;
  }
  html,body{
    height:100%;
    margin:0;
    background: radial-gradient(circle at center, var(--bg1), var(--bg2));
    display:flex;
    align-items:center;
    justify-content:center;
    overflow:hidden;
    font-family: "Poppins", system-ui, sans-serif;
    perspective:1200px;
  }

  /* === D√íNG CH·ªÆ CH√öC M·ª™NG === */
  .message {
    position: absolute;
    top: 40px;
    left: 50%;
    transform: translateX(-50%);
    text-align: center;
    z-index: 99999;
  }

  .message h1 {
    color: #e60073;
    font-size: 42px;
    margin: 0;
    font-weight: 800;
    text-shadow: 0 0 12px #fff, 0 0 20px #ff7eb9;
  }

  .message h2 {
    color: #d63384;
    font-size: 20px;
    font-weight: 600;
    margin-top: 8px;
    text-shadow: 0 0 10px #fff;
  }

  /* Khung ch·ª©a carousel */
  .stage {
    width: 760px;
    height: 520px;
    position: relative;
    transform-style: preserve-3d;
  }

  /* V√≤ng quay ·∫£nh */
  .carousel {
    position: absolute;
    left: 50%;
    top: 50%;
    width: 600px;
    height: 600px;
    transform: translate(-50%,-50%);
    transform-style: preserve-3d;
  }

  .carousel img {
    position: absolute;
    left: 50%;
    top: 50%;
    width: 120px;
    height: 120px;
    margin: -60px 0 0 -60px;
    border-radius: 14px;
    object-fit: cover;
    box-shadow: 0 8px 24px rgba(0,0,0,0.18);
    transition: transform 300ms cubic-bezier(.2,.9,.2,1), filter 300ms, opacity 300ms;
    will-change: transform, opacity;
    opacity: 0.95;
    backface-visibility: hidden;
  }

  .carousel img.front {
    transform: translate3d(var(--x), var(--y), var(--z)) scale(1.38) !important;
    filter: saturate(1.05) drop-shadow(0 20px 40px rgba(0,0,0,0.35));
    z-index: 9999;
    opacity: 1;
  }

  .carousel img.back {
    transform: translate3d(var(--x), var(--y), var(--z)) scale(1);
    z-index: 1;
    opacity: 0.92;
    filter: saturate(0.98);
  }

  @media (max-width:900px){
    .message h1{font-size:32px;}
    .stage{ width:90vw; height:70vh; }
    .carousel{ width:85vw; height:85vw; }
    .carousel img{ width:86px; height:86px; margin:-43px 0 0 -43px; }
  }

  /* === HOA R∆†I === */
  .petal {
    position: fixed;
    top: -2em;
    animation: fall linear infinite;
    opacity: 0.8;
    z-index: 9999;
    pointer-events: none;
  }

  @keyframes fall {
    0% { transform: translateY(0) rotate(0deg); opacity: 1; }
    100% { transform: translateY(110vh) rotate(360deg); opacity: 0; }
  }
</style>
</head>
<body>

  <!-- D√≤ng ch√∫c m·ª´ng -->
  <div class="message">
    <h1>üå∏ Ch√∫c m·ª´ng ng√†y 20/10 üíê</h1>
    <h2>Ch√∫c b·∫°n lu√¥n xinh ƒë·∫πp, h·∫°nh ph√∫c & t·ªèa s√°ng nh∆∞ nh·ªØng b√¥ng hoa!</h2>
  </div>

  <!-- V√≤ng quay ·∫£nh -->
  <div class="stage">
    <div class="carousel" id="carousel"></div>
  </div>

  <!-- üéµ Nh·∫°c n·ªÅn (th√™m gi·ªëng file tr∆∞·ªõc) -->
  <audio id="player" src="./assets/a.mp3" loop></audio>

<script>
/* === ·∫¢NH QUAY 3D === */
const COUNT = 21;
const radius = 260;
const spinSpeed = 0.0085;
const carousel = document.getElementById('carousel');
const items = [];

for(let i=0;i<COUNT;i++){
  const im = document.createElement('img');
  im.src = `anh(${i+1}).jpg`;
  im.alt = `·∫£nh ${i+1}`;
  im.classList.add('back');
  carousel.appendChild(im);
  items.push(im);
}

const baseAngles = items.map((_, i) => (i / COUNT) * Math.PI * 2);

let angle = 0;
function render(){
  angle += spinSpeed;

  let frontIndex = 0;
  let maxZ = -Infinity;

  for(let i=0;i<COUNT;i++){
    const el = items[i];
    const base = baseAngles[i];
    const theta = base + angle;
    const x = Math.cos(theta) * radius;
    const z = Math.sin(theta) * radius;
    const y = 0;
    const depthScale = 1 + (z / (radius*4));
    const deg = theta * 180 / Math.PI;

    el.style.setProperty('--x', x + 'px');
    el.style.setProperty('--y', y + 'px');
    el.style.setProperty('--z', z + 'px');
    el.style.transform = `translate3d(${x}px, ${y}px, ${z}px) rotate(${-deg}deg) scale(${depthScale})`;

    if (z > maxZ) { maxZ = z; frontIndex = i; }
    el.style.zIndex = Math.round(z + 2000);
  }

  items.forEach((el, idx) => {
    if (idx === frontIndex) {
      el.classList.add('front');
      el.classList.remove('back');
      const theta = baseAngles[idx] + angle;
      const deg = theta * 180 / Math.PI;
      const x = Math.cos(theta) * radius;
      const z = Math.sin(theta) * radius;
      const depthScale = 1.35;
      el.style.transform = `translate3d(${x}px, 0px, ${z}px) rotate(${-deg}deg) scale(${depthScale})`;
      el.style.zIndex = 10000;
      el.style.opacity = '1';
    } else {
      el.classList.remove('front');
      el.classList.add('back');
      el.style.opacity = '0.92';
    }
  });

  requestAnimationFrame(render);
}
render();

/* === HOA R∆†I === */
const icons =  ["‚ù§Ô∏è", "üíê", "üéÅ", "üåπ", "üíï", "üíñ"];
for (let i = 0; i < 25; i++) {
  const petal = document.createElement('div');
  petal.className = 'petal';
  petal.textContent = icons[Math.floor(Math.random() * icons.length)];
  petal.style.left = Math.random() * 100 + 'vw';
  petal.style.animationDuration = 5 + Math.random() * 5 + 's';
  petal.style.fontSize = 18 + Math.random() * 18 + 'px';
  document.body.appendChild(petal);
}

/* === PH√ÅT NH·∫†C T·ª∞ ƒê·ªòNG === */
const player = document.getElementById('player');
document.body.addEventListener('click', () => {
  player.play().catch(()=>{});
}, { once: true });
</script>
</body>
</html>
